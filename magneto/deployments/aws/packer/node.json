{
    "variables": {
        "host_name": "node"
    },
    "builders": [
        {
            "type": "amazon-ebs",
            "source_ami": "ami-0977029b5b13f3d08",
            "instance_type": "t3.micro",
            "ssh_username": "ubuntu",
            "ami_name": "{{user `host_name`}}-{{isotime \"2006-01-02-1504\"}}"
        }
    ],
    "provisioners": [
        {
            "type": "ansible",
            "user": "ubuntu",
            "playbook_file": "../ansible/base/main.yaml",
            "extra_arguments": [ "--extra-vars", "host_name={{user `host_name`}}" ]
        }
    ]
}

